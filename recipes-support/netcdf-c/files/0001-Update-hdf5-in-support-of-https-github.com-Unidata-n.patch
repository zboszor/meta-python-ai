From 741c4b4a909179d3fce56b60eede7ee5332af349 Mon Sep 17 00:00:00 2001
From: Ward Fisher <wfisher@ucar.edu>
Date: Tue, 9 Dec 2025 16:07:00 -0700
Subject: [PATCH] Update hdf5 in support of
 https://github.com/Unidata/netcdf-c/issues/3202

Upstream-Status: Backport
---
 libhdf5/H5FDhttp.c | 10 ++++------
 libhdf5/H5FDhttp.h |  3 ++-
 2 files changed, 6 insertions(+), 7 deletions(-)

diff --git a/libhdf5/H5FDhttp.c b/libhdf5/H5FDhttp.c
index 917c73a11..99043f8fa 100644
--- a/libhdf5/H5FDhttp.c
+++ b/libhdf5/H5FDhttp.c
@@ -49,12 +49,10 @@
 Define a simple #ifdef test for the version of H5FD_class_t we are using 
 */
 
-#if H5_VERS_MAJOR == 1
-#if H5_VERS_MINOR < 10
-#define H5FDCLASS1 1
-#endif
-#else
-#error "Cannot determine version of H5FD_class_t"
+#if H5_VERS_MAJOR == 1 
+    #if H5_VERS_MINOR < 10
+        #define H5FDCLASS1 1
+    #endif
 #endif
 
 #ifdef H5_HAVE_WIN32_API
diff --git a/libhdf5/H5FDhttp.h b/libhdf5/H5FDhttp.h
index 376609e9f..bc973a56f 100644
--- a/libhdf5/H5FDhttp.h
+++ b/libhdf5/H5FDhttp.h
@@ -31,7 +31,8 @@
 
 #if H5_VERSION_GE(1,13,2)
 #define H5_VFD_HTTP     ((H5FD_class_value_t)(514))
-#define H5FD_HTTP	(H5FDperform_init(H5FD_http_init))
+//#define H5FD_HTTP	(H5FDperform_init(H5FD_http_init))
+#define H5FD_HTTP (H5OPEN H5FD_http_init())
 #else
 #define H5FD_HTTP	(H5FD_http_init())
 #endif
-- 
2.53.0

